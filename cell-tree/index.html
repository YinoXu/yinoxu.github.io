<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Cell-type trees: human annotations and Xenium panels</title>
<style>
  body {
    font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    margin: 16px;
    line-height: 1.4;
  }
  h1 {
    margin-top: 0;
  }
  .layout {
    display: flex;
    gap: 12px;
    align-items: flex-start;
  }
  .tree-panel {
    flex: 1 1 22%;
    max-width: 25%;
    border: 1px solid #ccc;
    border-radius: 6px;
    padding: 8px 10px 10px 10px;
    box-sizing: border-box;
    font-size: 13px;
  }
  #info-panel {
    flex: 1 1 30%;
    max-width: 28%;
    border: 1px solid #ccc;
    border-radius: 6px;
    padding: 8px 10px 10px 10px;
    box-sizing: border-box;
    font-size: 13px;
  }
  .tree-panel h2 {
    font-size: 14px;
    margin: 0 0 4px 0;
  }
  .search-bar {
    margin-bottom: 6px;
  }
  .search-bar input {
    width: 100%;
    box-sizing: border-box;
    padding: 4px 6px;
    font-size: 12px;
  }
  .tree {
    max-height: 80vh;
    overflow: auto;
  }
  .tree ul {
    list-style-type: none;
    margin: 0;
    padding-left: 1em;
  }
  .tree li {
    margin: 2px 0;
  }
  .tree li > ul {
    display: none; /* collapsed by default */
  }
  .tree li.parent.expanded > ul {
    display: block;
  }
  .node-label {
    cursor: pointer;
    padding: 1px 3px;
    border-radius: 3px;
    display: inline-block;
  }
  .node-label.selected {
    background: #cce5ff;
  }
  .node-label.search-hit {
    background: #ffe699;
  }
  .tree li.parent > .node-label::before {
    content: "\25B6"; /* triangle */
    display: inline-block;
    width: 1em;
    margin-right: 3px;
    font-size: 0.75em;
    transform: rotate(0deg);
    transition: transform 0.15s ease-out;
    color: #555;
  }
  .tree li.parent.expanded > .node-label::before {
    transform: rotate(90deg);
  }
  .tree li.leaf > .node-label::before {
    content: "\2022";
    display: inline-block;
    width: 1em;
    margin-right: 3px;
    font-size: 0.75em;
    color: #999;
  }
  #info-panel h3 {
    margin-top: 0;
    font-size: 14px;
  }
  #node-description div {
    margin-bottom: 4px;
  }
  h2.section-title {
    margin-top: 24px;
    font-size: 15px;
  }
  table.mapping-table {
    border-collapse: collapse;
    font-size: 12px;
    margin-top: 6px;
    width: 100%;
    max-width: 1000px;
  }
  table.mapping-table th,
  table.mapping-table td {
    border: 1px solid #ccc;
    padding: 4px 6px;
    vertical-align: top;
  }
  table.mapping-table th {
    background: #f5f5f5;
  }
</style>
</head>
<body>

<h1>Cell-type trees: integrated taxonomy, human labels, and Xenium panels</h1>
<p style="max-width: 950px;">
Tree&nbsp;1 combines all human histopathology labels and Xenium cell types into a biologically detailed taxonomy, with explicit tumour vs non-tumour separation.
Tree&nbsp;2 focuses only on human annotator labels from the table.
Tree&nbsp;3 focuses only on Xenium cell labels from all panels.
The same label is allowed to appear under multiple parents (multi-class semantics).
Click any node to see its lineage and description on the right.
</p>

<div class="search-bar" style="max-width: 420px; margin: 8px 0 12px 0;">
  <input type="text" placeholder="Global search across all trees..." oninput="searchAllTrees(event)">
</div>

<div class="layout">
  <div class="tree-panel" id="tree1">
    <h2>Tree 1 – Integrated cell taxonomy</h2>
    <div class="search-bar">
      <input type="text" placeholder="Search in Tree 1..." oninput="searchTree(event, 'tree1')">
    </div>
    <div class="tree">
      <ul></ul>
    </div>
  </div>

  <div class="tree-panel" id="tree2">
    <h2>Tree 2 – Human annotator label hierarchy</h2>
    <div class="search-bar">
      <input type="text" placeholder="Search in Tree 2..." oninput="searchTree(event, 'tree2')">
    </div>
    <div class="tree">
      <ul></ul>
    </div>
  </div>

  <div class="tree-panel" id="tree3">
    <h2>Tree 3 – Xenium label hierarchy</h2>
    <div class="search-bar">
      <input type="text" placeholder="Search in Tree 3..." oninput="searchTree(event, 'tree3')">
    </div>
    <div class="tree">
      <ul></ul>
    </div>
  </div>

  <div id="info-panel">
    <h3>Node information</h3>
    <div id="node-description">
      Click any node in the trees to see its lineage and a morphological / biological description here.
    </div>
  </div>
</div>

<h2 class="section-title">Human annotator labels by dataset</h2>
<table class="mapping-table">
  <tr>
    <th>Dataset</th>
    <th>Cell labels (as used in the original dataset)</th>
  </tr>
  <tr>
    <td>DigestPath2019 (Signet ring cell)</td>
    <td>ring_cell_cancer</td>
  </tr>
  <tr>
    <td>CoNSeP</td>
    <td>
      other<br>
      inflammatory<br>
      healthy epithelial<br>
      dysplastic/malignant epithelial<br>
      fibroblast<br>
      muscle<br>
      endothelial
    </td>
  </tr>
  <tr>
    <td>BreCaHAD</td>
    <td>
      apoptosis<br>
      mitosis<br>
      non-mitosis<br>
      non-tubule (non-lumen)<br>
      non-tumor nuclei<br>
      tubule (lumen)<br>
      tumor nuclei
    </td>
  </tr>
  <tr>
    <td>Lizard</td>
    <td>
      neutrophil<br>
      epithelial<br>
      lymphocyte<br>
      plasma<br>
      eosinophil<br>
      connective tissue
    </td>
  </tr>
  <tr>
    <td>MoNuSAC</td>
    <td>
      Lymphocyte<br>
      Epithelial<br>
      Ambiguous<br>
      Macrophage<br>
      Neutrophil
    </td>
  </tr>
  <tr>
    <td>NuCLS</td>
    <td>
      tumor<br>
      fibroblast<br>
      unlabeled<br>
      lymphocyte<br>
      plasma_cell<br>
      macrophage<br>
      vascular_endothelium<br>
      apoptotic_body<br>
      mitotic_figure<br>
      neutrophil<br>
      myoepithelium<br>
      eosinophil
    </td>
  </tr>
  <tr>
    <td>PanNuke</td>
    <td>
      Neoplastic<br>
      Inflammatory<br>
      Connective / soft tissue<br>
      Dead<br>
      Epithelial<br>
      Background (non-nuclei)
    </td>
  </tr>
  <tr>
    <td>PanopTILs (PanopTILS)</td>
    <td>
      CancerEpithelium<br>
      StromalCellNOS<br>
      TILsCell<br>
      UnknownOrAmbiguousCell<br>
      ActiveStromalCellNOS<br>
      ActiveTILsCell<br>
      OtherCell<br>
      NormalEpithelium
    </td>
  </tr>
  <tr>
    <td>nuclei.io CRC tumor</td>
    <td>
      Non-neoplastic<br>
      Neoplastic
    </td>
  </tr>
  <tr>
    <td>nuclei.io plasma cells</td>
    <td>
      Other<br>
      Plasma cell
    </td>
  </tr>
</table>

<h2 class="section-title">Xenium labels by dataset</h2>
<table class="mapping-table">
  <tr>
    <th>Xenium dataset</th>
    <th>Cell labels (as used per dataset)</th>
  </tr>
  <tr>
    <td>Breast_Entire-Sample-Area-S1</td>
    <td>
      Macrophage<br>
      Malignant<br>
      Mast_Cell<br>
      Tumor_Associated_Endothelial<br>
      Tumor_Associated_Fibroblast
    </td>
  </tr>
  <tr>
    <td>Colon_Preview_Data_Cancer+pre-designed+add-on</td>
    <td>
      Endothelial<br>
      Macrophage<br>
      Malignant<br>
      Smooth_Muscle<br>
      Tumor_Associated_Fibroblast
    </td>
  </tr>
  <tr>
    <td>Heart-MultiCancerPanel</td>
    <td>
      Cardiomyocyte<br>
      Endothelial<br>
      Fibroblast<br>
      Myeloid<br>
      SMC/Pericyte
    </td>
  </tr>
  <tr>
    <td>Kidney-MultiCancerPanel-Cancer</td>
    <td>
      Ambiguous/Low_confidence<br>
      B_lineage<br>
      Endothelial<br>
      Fibroblast/CAF<br>
      Myeloid<br>
      T_cells<br>
      Tumor_epithelial
    </td>
  </tr>
  <tr>
    <td>Liver-MultiCancerPanel-Cancer</td>
    <td>
      Ambiguous/Low_confidence<br>
      Endothelial<br>
      Fibroblast/CAF<br>
      Myeloid<br>
      T_cells<br>
      Tumor_epithelial
    </td>
  </tr>
  <tr>
    <td>Lung-Cancer-v1+5k</td>
    <td>
      Airway_epithelium<br>
      Alveolar<br>
      B_lineage<br>
      Endothelial<br>
      Fibroblast_PDGFRA_CAF<br>
      Myeloid<br>
      SMC/Pericyte<br>
      T_cells<br>
      Tumor_epithelial
    </td>
  </tr>
  <tr>
    <td>Xenium_Prime_Ovarian_Cancer_FFPE_XRrun</td>
    <td>
      Ciliated Epithelial Cells<br>
      Fallopian Tube Epithelium<br>
      Granulosa Cells<br>
      Inflammatory Tumor Cells<br>
      Macrophages<br>
      Malignant Cells Lining Cyst<br>
      Pericytes<br>
      Proliferative Tumor Cells<br>
      SOX2-OT+ Tumor Cells<br>
      Smooth Muscle Cells<br>
      Stromal Associated Endothelial Cells<br>
      Stromal Associated Fibroblasts<br>
      T and NK Cells<br>
      Tumor Associated Endothelial Cells<br>
      Tumor Associated Fibroblasts<br>
      Tumor Cells<br>
      Unassigned<br>
      VEGFA+ Tumor Cells
    </td>
  </tr>
  <tr>
    <td>Xenium_V1_hPancreas_Cancer_Add_on_FFPE</td>
    <td>
      Acinar<br>
      B Cells<br>
      CFTR- Tumor Cells<br>
      CXCL9/10 Cells<br>
      Ductal<br>
      Endocrine 1<br>
      Endocrine 2<br>
      Endothelial<br>
      Fibroblasts<br>
      Lymphatic Endothelial Cells<br>
      Macrophages<br>
      Mast Cells<br>
      Metaplastic Cells<br>
      Smooth Muscle Cells<br>
      T Cells<br>
      Tumor Cells
    </td>
  </tr>
</table>

<script>
// ------------------------
// DATA: three trees
// ------------------------
const treeData = {
  "tree1": {
    "name": "Tree 1 – Integrated cell taxonomy",
    "desc": "Combined biological taxonomy covering all human histopathology labels and Xenium cell types, explicitly separating non-tumour vs tumour and allowing multi-parent semantics for some labels.",
    "children": [
      {
        "name": "Epithelial lineage",
        "desc": "Cells derived from epithelial lineages lining surfaces and glands (breast ducts, colonic crypts, gastric mucosa, airway epithelium, pancreatic ducts/acini, ovarian surface/follicles).",
        "children": [
          {
            "name": "Non-neoplastic epithelial cells",
            "desc": "Benign epithelial cells with preserved polarity, relatively uniform nuclei and no clear invasion. Includes surface mucosal epithelium, normal glands and benign ductal/acinar structures.",
            "children": [
              { "name": "healthy epithelial", "desc": "Human label 'healthy epithelial' (CoNSeP): benign colorectal epithelium with preserved crypt architecture and bland nuclei.", "children": [] },
              { "name": "epithelial", "desc": "Human label 'epithelial' (Lizard): colonic epithelial cells lining glands and crypts; non-neoplastic when away from tumours.", "children": [] },
              { "name": "Epithelial", "desc": "Human label 'Epithelial' (MoNuSAC, PanNuke): nuclei judged epithelial but not necessarily specified as benign or malignant; the benign subset belongs here.", "children": [] },
              { "name": "NormalEpithelium", "desc": "Human label 'NormalEpithelium' (PanopTILs): normal breast epithelium adjacent to invasive tumour.", "children": [] },
              { "name": "non-tumor nuclei", "desc": "Human label 'non-tumor nuclei' (BreCaHAD): nuclei judged non-neoplastic (either benign epithelium or stroma).", "children": [] },
              { "name": "Non-neoplastic", "desc": "Human label 'Non-neoplastic' (nuclei.io CRC tumor): nuclei in CRC patches that are not tumour, including benign epithelium and stroma.", "children": [] },
              { "name": "tubule (lumen)", "desc": "Human label 'tubule (lumen)' (BreCaHAD): epithelial nuclei lining luminal glandular structures, a hallmark of well-differentiated adenocarcinoma but also present in benign glands.", "children": [] },
              { "name": "Airway_epithelium", "desc": "Xenium label 'Airway_epithelium' (lung panel): pseudostratified ciliated and secretory cells lining bronchial airways, non-malignant in origin.", "children": [] },
              { "name": "Alveolar", "desc": "Xenium label 'Alveolar' (lung panel): type I and type II pneumocytes lining alveolar spaces, delicate epithelial barrier for gas exchange.", "children": [] },
              { "name": "Ciliated Epithelial Cells", "desc": "Xenium ovarian label 'Ciliated Epithelial Cells': ciliated epithelium with apical cilia and elongated nuclei, e.g. fimbrial/tubal epithelium.", "children": [] },
              { "name": "Fallopian Tube Epithelium", "desc": "Xenium ovarian label 'Fallopian Tube Epithelium': specialised ciliated and secretory epithelium lining the fallopian tube.", "children": [] },
              { "name": "Ductal", "desc": "Xenium pancreas label 'Ductal': epithelial cells lining exocrine ducts, forming a single layer around the lumen.", "children": [] },
              { "name": "Acinar", "desc": "Xenium pancreas label 'Acinar': exocrine acinar cells arranged in grape-like clusters around a tiny lumen, producing digestive enzymes.", "children": [] },
              { "name": "Granulosa Cells", "desc": "Xenium ovarian label 'Granulosa Cells': ovarian follicular cells that support the oocyte and secrete hormones; epithelial/mesenchymal-like, typically benign in non-neoplastic follicles.", "children": [] }
            ]
          },
          {
            "name": "Pre-malignant / dysplastic epithelial cells",
            "desc": "Epithelial cells showing architectural crowding and nuclear atypia but not clearly invasive; lie on the spectrum between benign and malignant.",
            "children": [
              { "name": "dysplastic/malignant epithelial", "desc": "Human label from CoNSeP: mixed class of dysplastic and malignant colorectal epithelial nuclei, often used for high-grade dysplasia and early carcinoma. Appears both here (pre-malignant) and under malignant contexts.", "children": [] }
            ]
          },
          {
            "name": "Malignant epithelial / tumour cells",
            "desc": "Frankly malignant epithelial cells (carcinoma) with nuclear pleomorphism, hyperchromasia, abnormal mitoses and invasion through the basement membrane.",
            "children": [
              {
                "name": "Generic carcinoma nuclei",
                "desc": "Core malignant epithelial populations, independent of special morphology or molecular subtype.",
                "children": [
                  { "name": "tumor nuclei", "desc": "Human label 'tumor nuclei' (BreCaHAD): malignant nuclei in breast invasive ductal carcinoma.", "children": [] },
                  { "name": "tumor", "desc": "Human label 'tumor' (NuCLS): malignant epithelial nuclei in TCGA-BRCA H&E slides.", "children": [] },
                  { "name": "Neoplastic", "desc": "Human label 'Neoplastic' (PanNuke, nuclei.io CRC tumor): tumour nuclei in multi-organ patches and colorectal cancer patches.", "children": [] },
                  { "name": "CancerEpithelium", "desc": "Human label 'CancerEpithelium' (PanopTILs): invasive breast carcinoma epithelium.", "children": [] },
                  { "name": "Tumor_epithelial", "desc": "Xenium multi-cancer label 'Tumor_epithelial' (kidney, liver, lung): epithelial tumour cells defined at panel level.", "children": [] },
                  { "name": "Malignant", "desc": "Xenium label 'Malignant' (breast, colon panels): generic malignant tumour population defined by expression-based clustering.", "children": [] },
                  { "name": "Tumor Cells", "desc": "Xenium ovarian / pancreas label 'Tumor Cells': main malignant cluster of tumour epithelial cells.", "children": [] },
                  { "name": "CFTR- Tumor Cells", "desc": "Xenium pancreas label 'CFTR- Tumor Cells': malignant cells lacking CFTR expression, representing a specific transcriptomic subtype.", "children": [] }
                ]
              },
              {
                "name": "State-specific malignant subtypes",
                "desc": "Malignant epithelial cells with additional functional programmes such as proliferation, angiogenesis or inflammatory signalling.",
                "children": [
                  { "name": "Proliferative Tumor Cells", "desc": "Xenium ovarian label 'Proliferative Tumor Cells': malignant cells enriched for cell-cycle and proliferation genes; also appears under the cell-state branch.", "children": [] },
                  { "name": "VEGFA+ Tumor Cells", "desc": "Xenium ovarian label 'VEGFA+ Tumor Cells': malignant cells overexpressing VEGFA, driving tumour angiogenesis; also conceptually linked to tumour-associated endothelium.", "children": [] },
                  { "name": "Inflammatory Tumor Cells", "desc": "Xenium ovarian label 'Inflammatory Tumor Cells': tumour cells with interferon/inflammatory signatures, often at immune–tumour interfaces.", "children": [] },
                  { "name": "SOX2-OT+ Tumor Cells", "desc": "Xenium ovarian label 'SOX2-OT+ Tumor Cells': malignant cells expressing SOX2-OT lncRNA, associated with stemness and neural-like programmes.", "children": [] },
                  { "name": "Malignant Cells Lining Cyst", "desc": "Xenium ovarian label 'Malignant Cells Lining Cyst': malignant epithelial cells lining cystic spaces within the tumour.", "children": [] }
                ]
              },
              {
                "name": "Special carcinoma morphology",
                "desc": "Distinct morphologic carcinoma variants.",
                "children": [
                  { "name": "ring_cell_cancer", "desc": "DigestPath2019 label 'ring_cell_cancer': signet-ring cell carcinoma cells with large mucin vacuoles displacing crescent-shaped nuclei.", "children": [] }
                ]
              },
              {
                "name": "Dysplastic label in malignant context",
                "desc": "Same dysplastic class but considered in its malignant portion.",
                "children": [
                  { "name": "dysplastic/malignant epithelial", "desc": "CoNSeP 'dysplastic/malignant epithelial' when used to represent frankly invasive carcinoma; multi-parent label appearing under both pre-malignant and malignant nodes.", "children": [] }
                ]
              }
            ]
          },
          {
            "name": "Tumour-associated / metaplastic epithelial cells",
            "desc": "Epithelial cells that undergo reprogramming in proximity to tumour, including metaplasia and other non-classical differentiation patterns.",
            "children": [
              { "name": "Metaplastic Cells", "desc": "Xenium pancreas label 'Metaplastic Cells': epithelial cells showing metaplastic change in the carcinoma microenvironment, often considered tumour-associated epithelial.", "children": [] }
            ]
          },
          {
            "name": "Endocrine epithelial cells",
            "desc": "Epithelial-derived cells with hormone-secreting function, often with 'salt-and-pepper' chromatin and nested architecture.",
            "children": [
              { "name": "Endocrine 1", "desc": "Xenium pancreas label 'Endocrine 1': one endocrine islet cell subtype, likely corresponding to a specific hormone-producing population.", "children": [] },
              { "name": "Endocrine 2", "desc": "Xenium pancreas label 'Endocrine 2': a second endocrine islet cell subtype, distinct from Endocrine 1 in transcriptomic profile.", "children": [] }
            ]
          }
        ]
      },
      {
        "name": "Stromal / connective lineage",
        "desc": "Supportive cells producing extracellular matrix and shaping stromal architecture, including fibroblasts and connective tissue cells.",
        "children": [
          {
            "name": "Non-tumour fibroblast / connective tissue cells",
            "desc": "Quiescent or weakly activated fibroblasts and generic connective tissue nuclei in benign stroma.",
            "children": [
              { "name": "fibroblast", "desc": "Human label 'fibroblast' (CoNSeP, NuCLS): stromal fibroblasts with spindle-shaped nuclei and scant cytoplasm.", "children": [] },
              { "name": "connective tissue", "desc": "Human label 'connective tissue' (Lizard): fibroblast-like and other stromal nuclei in colonic lamina propria.", "children": [] },
              { "name": "Connective / soft tissue", "desc": "Human label 'Connective / soft tissue' (PanNuke): stromal nuclei including fibroblasts and soft tissue cells.", "children": [] },
              { "name": "StromalCellNOS", "desc": "Human label 'StromalCellNOS' (PanopTILs): stromal cells not otherwise specified, mostly fibroblasts.", "children": [] },
              { "name": "Fibroblast", "desc": "Xenium label 'Fibroblast' (heart panel): generic cardiac fibroblasts maintaining myocardial matrix.", "children": [] },
              { "name": "Fibroblasts", "desc": "Xenium label 'Fibroblasts' (pancreas): stromal fibroblasts in the pancreas specimen.", "children": [] },
              { "name": "Stromal Associated Fibroblasts", "desc": "Xenium label 'Stromal Associated Fibroblasts' (ovarian): fibroblasts associated with non-tumour stroma.", "children": [] },
              { "name": "Non-neoplastic", "desc": "Human label 'Non-neoplastic' (CRC tumour patches) also includes non-neoplastic stroma; appears both under epithelial and stromal contexts.", "children": [] }
            ]
          },
          {
            "name": "Tumour-associated fibroblasts (CAF-like)",
            "desc": "Fibroblasts activated by tumour-derived signals (CAF), with plumper nuclei and strong secretory activity that remodels the tumour microenvironment.",
            "children": [
              { "name": "ActiveStromalCellNOS", "desc": "Human label 'ActiveStromalCellNOS' (PanopTILs): activated stromal cells, often CAF-like around invasive breast carcinoma.", "children": [] },
              { "name": "Tumor_Associated_Fibroblast", "desc": "Xenium label 'Tumor_Associated_Fibroblast' (breast, colon panels): fibroblasts physically and transcriptionally associated with tumour regions.", "children": [] },
              { "name": "Tumor Associated Fibroblasts", "desc": "Xenium label 'Tumor Associated Fibroblasts' (ovarian): CAFs in the ovarian tumour microenvironment.", "children": [] },
              { "name": "Fibroblast/CAF", "desc": "Xenium label 'Fibroblast/CAF' (kidney, liver panels): combined class including fibroblasts and CAFs.", "children": [] },
              { "name": "Fibroblast_PDGFRA_CAF", "desc": "Xenium label 'Fibroblast_PDGFRA_CAF' (lung): PDGFRA-high fibroblast/CAF cluster strongly associated with tumour stroma.", "children": [] }
            ]
          },
          {
            "name": "Non-lumen / solid stromal regions",
            "desc": "Regions that are clearly non-luminal and may contain a mixture of stromal and tumour nuclei.",
            "children": [
              { "name": "non-tubule (non-lumen)", "desc": "Human label 'non-tubule (non-lumen)' (BreCaHAD): regions without glandular lumen, often solid tumour and stromal admixture; appears here and under epithelial structural context.", "children": [] }
            ]
          }
        ]
      },
      {
        "name": "Endothelial / vascular lineage",
        "desc": "Endothelial cells lining blood and lymphatic vessels, including normal and tumour-associated vasculature.",
        "children": [
          {
            "name": "Non-tumour vascular endothelial cells",
            "desc": "Endothelial cells in normal or non-tumour vessels, maintaining barrier and transport functions.",
            "children": [
              { "name": "endothelial", "desc": "Human label 'endothelial' (CoNSeP): vascular endothelium in colorectal tissue.", "children": [] },
              { "name": "vascular_endothelium", "desc": "Human label 'vascular_endothelium' (NuCLS): blood vessel endothelium in TCGA breast slides.", "children": [] },
              { "name": "Endothelial", "desc": "Xenium label 'Endothelial' (colon, heart, lung, pancreas): generic vascular endothelial cells in those organs.", "children": [] },
              { "name": "Lymphatic Endothelial Cells", "desc": "Xenium pancreas label 'Lymphatic Endothelial Cells': lymphatic channel endothelium with thin-walled, irregular lumina.", "children": [] },
              { "name": "Stromal Associated Endothelial Cells", "desc": "Xenium ovarian label 'Stromal Associated Endothelial Cells': endothelial cells in vessels of the non-tumour stroma.", "children": [] }
            ]
          },
          {
            "name": "Tumour-associated endothelial cells",
            "desc": "Endothelial cells forming irregular tumour neovessels, often influenced by VEGFA+ tumour cells and hypoxia.",
            "children": [
              { "name": "Tumor_Associated_Endothelial", "desc": "Xenium label 'Tumor_Associated_Endothelial' (breast, colon panels): endothelial cells in tumour-associated neovessels.", "children": [] },
              { "name": "Tumor Associated Endothelial Cells", "desc": "Xenium ovarian label 'Tumor Associated Endothelial Cells': endothelial cells intimately associated with ovarian tumour tissue.", "children": [] }
            ]
          }
        ]
      },
      {
        "name": "Immune lineage",
        "desc": "Adaptive and innate immune cells, including lymphoid and myeloid lineages across human datasets and Xenium panels.",
        "children": [
          {
            "name": "Generic inflammatory cell classes",
            "desc": "Labels that deliberately mix different immune subsets into an 'inflammatory' bucket.",
            "children": [
              { "name": "inflammatory", "desc": "Human label 'inflammatory' (CoNSeP): mixed inflammatory infiltrate around colorectal glands.", "children": [] },
              { "name": "Inflammatory", "desc": "Human label 'Inflammatory' (PanNuke): mixed inflammatory nuclei in multi-organ patches.", "children": [] }
            ]
          },
          {
            "name": "T lymphocytes and TILs",
            "desc": "T cells mediating cell-mediated immunity and tumour-infiltrating lymphocytes.",
            "children": [
              { "name": "lymphocyte", "desc": "Human label 'lymphocyte' (Lizard, NuCLS): small round T/B cells with dense chromatin and scant cytoplasm.", "children": [] },
              { "name": "Lymphocyte", "desc": "Human label 'Lymphocyte' (MoNuSAC): multi-organ lymphocytes infiltrating tumours.", "children": [] },
              { "name": "TILsCell", "desc": "Human label 'TILsCell' (PanopTILs): tumour-infiltrating lymphocytes inside or adjacent to cancer epithelium.", "children": [] },
              { "name": "ActiveTILsCell", "desc": "Human label 'ActiveTILsCell' (PanopTILs): functionally activated TILs with high activation or exhaustion marker expression.", "children": [] },
              { "name": "T_cells", "desc": "Xenium multi-cancer label 'T_cells' (kidney, liver, lung): bulk T cell compartment in these panels.", "children": [] },
              { "name": "T Cells", "desc": "Xenium pancreas label 'T Cells': T cell cluster in pancreatic tumour microenvironment.", "children": [] },
              { "name": "T and NK Cells", "desc": "Xenium ovarian label 'T and NK Cells': mixed cluster of T cells and NK cells.", "children": [] }
            ]
          },
          {
            "name": "B lineage and plasma cells",
            "desc": "B cells, B-lineage cells and terminally differentiated plasma cells.",
            "children": [
              { "name": "B_lineage", "desc": "Xenium label 'B_lineage' (kidney, lung): B-lineage cells including naive and memory B cells.", "children": [] },
              { "name": "B Cells", "desc": "Xenium pancreas label 'B Cells': B lymphocytes in the pancreas panel.", "children": [] },
              { "name": "plasma", "desc": "Human label 'plasma' (Lizard): plasma cells with eccentric nuclei and perinuclear hof.", "children": [] },
              { "name": "plasma_cell", "desc": "Human label 'plasma_cell' (NuCLS): plasma cells in TCGA breast.", "children": [] },
              { "name": "Plasma cell", "desc": "Human label 'Plasma cell' (nuclei.io plasma cells): plasma cells in a dedicated dataset.", "children": [] }
            ]
          },
          {
            "name": "Myeloid lineage and macrophages",
            "desc": "Monocytes, macrophages, dendritic cells and other myeloid-derived cells.",
            "children": [
              { "name": "Macrophage", "desc": "Human label 'Macrophage' (MoNuSAC): tissue macrophages in multiple organs.", "children": [] },
              { "name": "macrophage", "desc": "Human label 'macrophage' (NuCLS): macrophages / histiocytes in breast cancer FOVs.", "children": [] },
              { "name": "Macrophage (Xenium)", "desc": "Xenium label 'Macrophage' (breast, colon panels): tumour-associated macrophages; conceptual node for Xenium context.", "children": [] },
              { "name": "Macrophages", "desc": "Xenium labels 'Macrophages' (ovarian, pancreas): macrophage populations in those organs.", "children": [] },
              { "name": "Myeloid", "desc": "Xenium label 'Myeloid' (heart, kidney, liver, lung): composite myeloid compartment including monocytes, DCs and some granulocytes.", "children": [] }
            ]
          },
          {
            "name": "Neutrophils and eosinophils",
            "desc": "Granulocytes involved in acute inflammation and allergic/parasitic responses.",
            "children": [
              { "name": "neutrophil", "desc": "Human label 'neutrophil' (Lizard, NuCLS): polymorphonuclear neutrophils with multilobed nuclei.", "children": [] },
              { "name": "Neutrophil", "desc": "Human label 'Neutrophil' (MoNuSAC): neutrophils across several organs.", "children": [] },
              { "name": "eosinophil", "desc": "Human label 'eosinophil' (Lizard, NuCLS): bilobed nuclei and bright eosinophilic granules.", "children": [] }
            ]
          },
          {
            "name": "Mast cells and CXCL9/10-high cells",
            "desc": "Mast cells with granules and chemokine-high activated immune clusters.",
            "children": [
              { "name": "Mast_Cell", "desc": "Xenium breast label 'Mast_Cell': tissue mast cells with granulated cytoplasm.", "children": [] },
              { "name": "Mast Cells", "desc": "Xenium pancreas label 'Mast Cells': mast cells in pancreatic tumour tissue.", "children": [] },
              { "name": "CXCL9/10 Cells", "desc": "Xenium pancreas label 'CXCL9/10 Cells': CXCL9/10 chemokine-high immune cells, often activated T or myeloid cells.", "children": [] }
            ]
          }
        ]
      },
      {
        "name": "Muscle / perivascular lineage",
        "desc": "Contractile cells including smooth muscle, pericytes and cardiomyocytes.",
        "children": [
          {
            "name": "Smooth muscle cells",
            "desc": "Smooth muscle cells with elongated, cigar-shaped nuclei in vessel walls or organ muscularis layers.",
            "children": [
              { "name": "muscle", "desc": "Human label 'muscle' (CoNSeP): smooth muscle or myofibroblast-like nuclei in colorectal specimens.", "children": [] },
              { "name": "Smooth_Muscle", "desc": "Xenium label 'Smooth_Muscle' (colon panel): mapped smooth muscle/perivascular smooth muscle cells.", "children": [] },
              { "name": "Smooth Muscle Cells", "desc": "Xenium labels 'Smooth Muscle Cells' (ovarian, pancreas): smooth muscle fibres in ovarian stroma and pancreatic vessels.", "children": [] }
            ]
          },
          {
            "name": "Pericytes and SMC/Pericyte",
            "desc": "Perivascular mural cells that wrap around capillaries and small vessels.",
            "children": [
              { "name": "SMC/Pericyte", "desc": "Xenium labels 'SMC/Pericyte' (heart, lung): combined smooth muscle cell and pericyte cluster around vessels.", "children": [] },
              { "name": "Pericytes", "desc": "Xenium ovarian label 'Pericytes': perivascular cells stabilising tumour microvessels.", "children": [] }
            ]
          },
          {
            "name": "Cardiomyocytes",
            "desc": "Striated cardiac muscle cells with abundant eosinophilic cytoplasm and central nuclei.",
            "children": [
              { "name": "Cardiomyocyte", "desc": "Xenium heart label 'Cardiomyocyte': working myocardial cells responsible for contraction.", "children": [] }
            ]
          }
        ]
      },
      {
        "name": "Endocrine / secretory lineage",
        "desc": "Hormone-producing and specialised secretory cells, many of which are also epithelial-derived.",
        "children": [
          {
            "name": "Endocrine cells (Xenium)",
            "desc": "Pancreatic islet endocrine cells and hormone-producing epithelial cells in Xenium data.",
            "children": [
              { "name": "Endocrine 1", "desc": "Xenium pancreas 'Endocrine 1': endocrine islet subtype; also appears under the epithelial lineage.", "children": [] },
              { "name": "Endocrine 2", "desc": "Xenium pancreas 'Endocrine 2': second endocrine subtype with distinct hormone profile.", "children": [] },
              { "name": "Granulosa Cells", "desc": "Xenium ovarian 'Granulosa Cells': steroidogenic follicular cells with endocrine function; appears both under epithelial and endocrine lineages.", "children": [] }
            ]
          },
          {
            "name": "Exocrine acinar cells",
            "desc": "Enzyme-secreting acinar cells in the pancreas and similar glands.",
            "children": [
              { "name": "Acinar", "desc": "Xenium pancreas 'Acinar': exocrine acinar cells forming lobules that secrete digestive enzymes; also listed under the epithelial lineage.", "children": [] }
            ]
          }
        ]
      },
      {
        "name": "Cell state / fate",
        "desc": "Dynamic states (proliferation, apoptosis, necrosis) that overlay any lineage and are often especially relevant in tumours.",
        "children": [
          {
            "name": "Mitotic and non-mitotic states",
            "desc": "Labels that explicitly describe whether a cell is in mitosis.",
            "children": [
              { "name": "mitosis", "desc": "Human label 'mitosis' (BreCaHAD): mitotic figures with condensed chromosomes; often tumour nuclei. Also linked to malignant epithelial nodes.", "children": [] },
              { "name": "mitotic_figure", "desc": "Human label 'mitotic_figure' (NuCLS): mitotic nuclei highlighted for cell cycle analysis.", "children": [] },
              { "name": "non-mitosis", "desc": "Human label 'non-mitosis' (BreCaHAD): nuclei explicitly annotated as not in mitosis, used as negative examples.", "children": [] },
              { "name": "Proliferative Tumor Cells", "desc": "Xenium ovarian label 'Proliferative Tumor Cells': malignant cells with a strong proliferation signature; appears both here (cell state) and under malignant epithelial lineage.", "children": [] }
            ]
          },
          {
            "name": "Apoptosis and cell death",
            "desc": "Labels for apoptotic cells, apoptotic bodies and dead nuclei.",
            "children": [
              { "name": "apoptosis", "desc": "Human label 'apoptosis' (BreCaHAD): apoptotic nuclei with condensed chromatin and nuclear fragmentation.", "children": [] },
              { "name": "apoptotic_body", "desc": "Human label 'apoptotic_body' (NuCLS): small membrane-bound apoptotic fragments.", "children": [] },
              { "name": "Dead", "desc": "Human label 'Dead' (PanNuke): dead or necrotic nuclei with karyorrhexis or karyolysis.", "children": [] }
            ]
          },
          {
            "name": "Functional tumour states (angiogenic / inflammatory)",
            "desc": "Transcriptional states of tumour cells related to angiogenesis or inflammatory signalling.",
            "children": [
              { "name": "VEGFA+ Tumor Cells", "desc": "Xenium ovarian 'VEGFA+ Tumor Cells': highly angiogenic malignant cells; also under malignant epithelial branch.", "children": [] },
              { "name": "Inflammatory Tumor Cells", "desc": "Xenium ovarian 'Inflammatory Tumor Cells': tumour cells with strong inflammatory/IFN signatures.", "children": [] }
            ]
          }
        ]
      },
      {
        "name": "Ambiguous / unknown / background",
        "desc": "Labels encoding uncertainty, low confidence or non-nuclear / background regions.",
        "children": [
          {
            "name": "Ambiguous / unknown nuclei",
            "desc": "Nuclei that annotators could not confidently assign to any canonical type.",
            "children": [
              { "name": "Ambiguous", "desc": "Human label 'Ambiguous' (MoNuSAC): nuclei not clearly epithelial, lymphocyte, macrophage or neutrophil.", "children": [] },
              { "name": "UnknownOrAmbiguousCell", "desc": "Human label 'UnknownOrAmbiguousCell' (PanopTILs): uncertain cell types in breast tumour ROIs.", "children": [] },
              { "name": "OtherCell", "desc": "Human label 'OtherCell' (PanopTILs): cells that do not fit tumour, stromal or immune classes.", "children": [] },
              { "name": "other", "desc": "Human label 'other' (CoNSeP): miscellaneous nuclei not fitting main phenotypes.", "children": [] },
              { "name": "Other", "desc": "Human label 'Other' (nuclei.io plasma cells): non-plasma nuclei grouped into an 'Other' bin.", "children": [] },
              { "name": "unlabeled", "desc": "Human label 'unlabeled' (NuCLS): nuclei without a consensus label.", "children": [] },
              { "name": "Ambiguous/Low_confidence", "desc": "Xenium label 'Ambiguous/Low_confidence' (kidney, liver panels): cells with low-confidence assignment or mixed signatures.", "children": [] },
              { "name": "Unassigned", "desc": "Xenium ovarian label 'Unassigned': cells that could not be robustly assigned to any cell type cluster.", "children": [] }
            ]
          },
          {
            "name": "Background / non-nuclear regions",
            "desc": "Areas explicitly annotated as not containing any nucleus or used to represent background tissue.",
            "children": [
              { "name": "Background (non-nuclei)", "desc": "Human label 'Background (non-nuclei)' (PanNuke): pixels with no nuclei (tissue, lumen, artifacts).", "children": [] }
            ]
          }
        ]
      }
    ]
  },

  "tree2": {
    "name": "Tree 2 – Human annotator label hierarchy",
    "desc": "Hierarchy built purely from human annotator labels in the table, organised by biological concept (epithelial, stromal, immune, endothelial, cell state, ambiguous). Node names are exactly the label strings (no dataset prefixes).",
    "children": [
      {
        "name": "Epithelial-related labels",
        "desc": "All human labels referring to epithelial cells, glands, or epithelial structures, grouped by tumour vs non-tumour context.",
        "children": [
          {
            "name": "Non-neoplastic epithelium",
            "desc": "Labels intended to reflect clearly benign epithelium or nuclear compartments of benign glands.",
            "children": [
              { "name": "healthy epithelial", "desc": "Benign colorectal epithelium in CoNSeP.", "children": [] },
              { "name": "epithelial", "desc": "Colonic epithelial nuclei in Lizard.", "children": [] },
              { "name": "Epithelial", "desc": "Epithelial nuclei class in MoNuSAC or PanNuke (benign subset).", "children": [] },
              { "name": "NormalEpithelium", "desc": "Benign breast epithelium in PanopTILs.", "children": [] },
              { "name": "non-tumor nuclei", "desc": "Non-tumour nuclei in BreCaHAD (often benign epithelium or stroma).", "children": [] },
              { "name": "Non-neoplastic", "desc": "Non-neoplastic nuclei in nuclei.io CRC tumour patches.", "children": [] },
              { "name": "tubule (lumen)", "desc": "Nuclei lining glandular lumina in BreCaHAD.", "children": [] }
            ]
          },
          {
            "name": "Dysplastic / pre-malignant epithelium",
            "desc": "Labels reflecting epithelial atypia between benign and malignant.",
            "children": [
              { "name": "dysplastic/malignant epithelial", "desc": "Mixed dysplastic and malignant epithelial nuclei class in CoNSeP; appears here and under malignant concepts.", "children": [] }
            ]
          },
          {
            "name": "Malignant / tumour epithelium",
            "desc": "Labels that the annotator uses for carcinoma nuclei.",
            "children": [
              { "name": "tumor nuclei", "desc": "Malignant nuclei in breast biopsies (BreCaHAD).", "children": [] },
              { "name": "tumor", "desc": "Tumour nuclei in NuCLS (TCGA breast).", "children": [] },
              { "name": "Neoplastic", "desc": "Neoplastic nuclei class in PanNuke and nuclei.io CRC tumour patches.", "children": [] },
              { "name": "CancerEpithelium", "desc": "Cancer epithelial nuclei in PanopTILs.", "children": [] },
              { "name": "ring_cell_cancer", "desc": "Signet-ring carcinoma nuclei in DigestPath2019.", "children": [] },
              { "name": "dysplastic/malignant epithelial", "desc": "CoNSeP dysplastic/malignant epithelial class considered from its malignant side.", "children": [] }
            ]
          },
          {
            "name": "Glandular structure / lumen vs non-lumen",
            "desc": "Labels describing whether nuclei are in tubular lumina or solid regions.",
            "children": [
              { "name": "tubule (lumen)", "desc": "Nuclei lining glandular lumina (also under non-neoplastic epithelium).", "children": [] },
              { "name": "non-tubule (non-lumen)", "desc": "Nuclei not forming clear lumina, including solid tumour and stroma.", "children": [] }
            ]
          },
          {
            "name": "Myoepithelium",
            "desc": "Specialised basal epithelial cell in breast glands.",
            "children": [
              { "name": "myoepithelium", "desc": "Basal myoepithelial nuclei in NuCLS.", "children": [] }
            ]
          }
        ]
      },
      {
        "name": "Stromal / connective labels",
        "desc": "Labels for fibroblasts, connective tissue and generic stromal nuclei.",
        "children": [
          {
            "name": "Fibroblast / connective tissue",
            "desc": "Stromal fibroblasts and generic connective tissue categories.",
            "children": [
              { "name": "fibroblast", "desc": "Stromal fibroblast nuclei (CoNSeP, NuCLS).", "children": [] },
              { "name": "connective tissue", "desc": "Connective tissue nuclei (Lizard).", "children": [] },
              { "name": "Connective / soft tissue", "desc": "Connective/soft tissue nuclei (PanNuke).", "children": [] },
              { "name": "StromalCellNOS", "desc": "Stromal cell not otherwise specified (PanopTILs).", "children": [] },
              { "name": "ActiveStromalCellNOS", "desc": "Activated stromal cell class, often CAF-like (PanopTILs).", "children": [] }
            ]
          },
          {
            "name": "Non-lumen / solid regions",
            "desc": "Labels where stromal and tumour nuclei are mixed in non-luminal regions.",
            "children": [
              { "name": "non-tubule (non-lumen)", "desc": "Non-lumen nuclei in BreCaHAD; appears here and under epithelial structural concepts.", "children": [] }
            ]
          }
        ]
      },
      {
        "name": "Endothelial labels",
        "desc": "Labels used for vascular endothelial nuclei.",
        "children": [
          {
            "name": "Blood vessel endothelium",
            "desc": "Endothelial cells lining blood vessels.",
            "children": [
              { "name": "endothelial", "desc": "Endothelial nuclei in CoNSeP.", "children": [] },
              { "name": "vascular_endothelium", "desc": "Vascular endothelium in NuCLS.", "children": [] }
            ]
          }
        ]
      },
      {
        "name": "Immune labels",
        "desc": "Human labels for lymphoid and myeloid cells and mixed inflammatory infiltrates.",
        "children": [
          {
            "name": "Generic inflammatory classes",
            "desc": "Non-specific inflammatory labels.",
            "children": [
              { "name": "inflammatory", "desc": "Mixed inflammatory cells in CoNSeP.", "children": [] },
              { "name": "Inflammatory", "desc": "Mixed inflammatory nuclei in PanNuke.", "children": [] }
            ]
          },
          {
            "name": "Lymphocytes and TILs",
            "desc": "T and B cells infiltrating tissue and tumours.",
            "children": [
              { "name": "lymphocyte", "desc": "Lymphocytes in Lizard and NuCLS.", "children": [] },
              { "name": "Lymphocyte", "desc": "Lymphocytes in MoNuSAC.", "children": [] },
              { "name": "TILsCell", "desc": "Tumour-infiltrating lymphocytes in PanopTILs.", "children": [] },
              { "name": "ActiveTILsCell", "desc": "Activated tumour-infiltrating lymphocytes in PanopTILs.", "children": [] }
            ]
          },
          {
            "name": "Plasma / B-lineage cells",
            "desc": "Plasma cells and related B-lineage labels.",
            "children": [
              { "name": "plasma", "desc": "Plasma cells in Lizard.", "children": [] },
              { "name": "plasma_cell", "desc": "Plasma cells in NuCLS.", "children": [] },
              { "name": "Plasma cell", "desc": "Plasma cells in nuclei.io plasma cell dataset.", "children": [] }
            ]
          },
          {
            "name": "Macrophages / histiocytes",
            "desc": "Mononuclear phagocytes.",
            "children": [
              { "name": "Macrophage", "desc": "Macrophages in MoNuSAC.", "children": [] },
              { "name": "macrophage", "desc": "Macrophages in NuCLS.", "children": [] }
            ]
          },
          {
            "name": "Neutrophils",
            "desc": "Neutrophil granulocytes.",
            "children": [
              { "name": "neutrophil", "desc": "Neutrophils in Lizard and NuCLS.", "children": [] },
              { "name": "Neutrophil", "desc": "Neutrophils in MoNuSAC.", "children": [] }
            ]
          },
          {
            "name": "Eosinophils",
            "desc": "Eosinophil granulocytes.",
            "children": [
              { "name": "eosinophil", "desc": "Eosinophils in Lizard and NuCLS.", "children": [] }
            ]
          }
        ]
      },
      {
        "name": "Cell state / fate labels",
        "desc": "Labels that describe proliferation or cell death rather than lineage.",
        "children": [
          {
            "name": "Mitotic state",
            "desc": "Mitotic vs non-mitotic nuclei.",
            "children": [
              { "name": "mitosis", "desc": "Mitotic figures in BreCaHAD.", "children": [] },
              { "name": "mitotic_figure", "desc": "Mitotic figures in NuCLS.", "children": [] },
              { "name": "non-mitosis", "desc": "Non-mitotic nuclei in BreCaHAD.", "children": [] }
            ]
          },
          {
            "name": "Apoptosis / death",
            "desc": "Apoptotic and dead nuclei.",
            "children": [
              { "name": "apoptosis", "desc": "Apoptotic nuclei in BreCaHAD.", "children": [] },
              { "name": "apoptotic_body", "desc": "Apoptotic bodies in NuCLS.", "children": [] },
              { "name": "Dead", "desc": "Dead nuclei in PanNuke.", "children": [] }
            ]
          }
        ]
      },
      {
        "name": "Ambiguous / unknown / background labels",
        "desc": "Labels encoding uncertainty, mixed types or non-nuclear regions.",
        "children": [
          {
            "name": "Ambiguous / other nuclei",
            "desc": "Human labels where the annotator was unsure or collapsed rare types.",
            "children": [
              { "name": "Ambiguous", "desc": "Ambiguous nuclei in MoNuSAC.", "children": [] },
              { "name": "UnknownOrAmbiguousCell", "desc": "Unknown or ambiguous cells in PanopTILs.", "children": [] },
              { "name": "OtherCell", "desc": "Other cells in PanopTILs.", "children": [] },
              { "name": "other", "desc": "Other nuclei in CoNSeP.", "children": [] },
              { "name": "Other", "desc": "Other nuclei in nuclei.io plasma cell dataset.", "children": [] },
              { "name": "unlabeled", "desc": "Unlabeled nuclei in NuCLS.", "children": [] }
            ]
          },
          {
            "name": "Background / non-nuclei",
            "desc": "Explicit non-nuclear pixels.",
            "children": [
              { "name": "Background (non-nuclei)", "desc": "Non-nuclear background in PanNuke.", "children": [] }
            ]
          }
        ]
      }
    ]
  },

  "tree3": {
    "name": "Tree 3 – Xenium label hierarchy",
    "desc": "Hierarchy built purely from Xenium cell labels across all listed panels. Leaf node names are exactly the Xenium label strings. Parents encode lineage, tumour vs non-tumour status and functional states; some labels appear under multiple parents.",
    "children": [
      {
        "name": "Epithelial and tumour lineage (Xenium)",
        "desc": "All Xenium epithelial-derived and tumour-epithelial classes, split into non-malignant, malignant and tumour-associated groups.",
        "children": [
          {
            "name": "Non-malignant epithelial cells (Xenium)",
            "desc": "Epithelial cells without clear malignant behaviour, including airway, alveolar, ductal, acinar and tubal epithelium.",
            "children": [
              { "name": "Airway_epithelium", "desc": "Lung panel: airway mucosal epithelium lining bronchi and bronchioles.", "children": [] },
              { "name": "Alveolar", "desc": "Lung panel: type I and II pneumocytes forming the alveolar lining.", "children": [] },
              { "name": "Ciliated Epithelial Cells", "desc": "Ovarian panel: ciliated epithelial cells with apical cilia.", "children": [] },
              { "name": "Fallopian Tube Epithelium", "desc": "Ovarian panel: specialised fallopian tube epithelium, often implicated in HGSC origins.", "children": [] },
              { "name": "Ductal", "desc": "Pancreas panel: ductal epithelial cells lining exocrine ducts.", "children": [] },
              { "name": "Acinar", "desc": "Pancreas panel: acinar exocrine cells producing digestive enzymes.", "children": [] },
              { "name": "Granulosa Cells", "desc": "Ovarian panel: granulosa cells in ovarian follicles, hormonally active but not malignant by default.", "children": [] }
            ]
          },
          {
            "name": "Malignant epithelial tumour cells (Xenium)",
            "desc": "Epithelial tumour cells across Xenium panels, including multi-cancer tumour_epithelial classes and ovarian/pancreas tumour clusters.",
            "children": [
              {
                "name": "Core malignant tumour populations",
                "desc": "Tumour-epithelial classes defined at the panel or cluster level.",
                "children": [
                  { "name": "Malignant", "desc": "Breast and colon panels: bulk malignant tumour cell cluster defined by gene expression.", "children": [] },
                  { "name": "Tumor_epithelial", "desc": "Kidney, liver, lung panels: tumour epithelial class at multi-cancer panel level.", "children": [] },
                  { "name": "Tumor Cells", "desc": "Ovarian and pancreas panels: main tumour epithelial cluster.", "children": [] },
                  { "name": "CFTR- Tumor Cells", "desc": "Pancreas panel: CFTR-negative tumour cells representing a specific malignant subtype.", "children": [] }
                ]
              },
              {
                "name": "State-specific malignant subtypes",
                "desc": "Ovarian tumour clusters with proliferative, inflammatory, angiogenic or cyst-lining signatures.",
                "children": [
                  { "name": "Proliferative Tumor Cells", "desc": "Ovarian: malignant cells with high expression of cell-cycle and proliferation genes.", "children": [] },
                  { "name": "VEGFA+ Tumor Cells", "desc": "Ovarian: VEGFA-high malignant cells that drive tumour angiogenesis.", "children": [] },
                  { "name": "Inflammatory Tumor Cells", "desc": "Ovarian: tumour cells activated by inflammatory/IFN pathways, often at immune interfaces.", "children": [] },
                  { "name": "SOX2-OT+ Tumor Cells", "desc": "Ovarian: tumour cells with SOX2-OT lncRNA expression, associated with stem-like features.", "children": [] },
                  { "name": "Malignant Cells Lining Cyst", "desc": "Ovarian: malignant cells forming the lining of cystic spaces.", "children": [] }
                ]
              }
            ]
          },
          {
            "name": "Tumour-associated / metaplastic epithelial cells (Xenium)",
            "desc": "Epithelial cells with strong tumour influence that are not simply generic malignant tumour cells.",
            "children": [
              { "name": "Metaplastic Cells", "desc": "Pancreas panel: metaplastic epithelial cells within or near tumour regions.", "children": [] }
            ]
          },
          {
            "name": "Endocrine epithelial cells (Xenium)",
            "desc": "Hormone-secreting epithelial cells and related endocrine populations.",
            "children": [
              { "name": "Endocrine 1", "desc": "Pancreas: first endocrine islet subtype.", "children": [] },
              { "name": "Endocrine 2", "desc": "Pancreas: second endocrine islet subtype with different hormone profile.", "children": [] },
              { "name": "Granulosa Cells", "desc": "Ovarian: granulosa cells with endocrine functions; duplicated here and under non-malignant epithelium.", "children": [] }
            ]
          }
        ]
      },
      {
        "name": "Fibroblast and stromal lineage (Xenium)",
        "desc": "Fibroblasts, fibroblast/CAF mixtures and CAFs across Xenium panels, separated into normal stromal vs tumour-associated categories.",
        "children": [
          {
            "name": "Non-tumour fibroblasts",
            "desc": "Fibroblasts in normal stroma or distant from the tumour core.",
            "children": [
              { "name": "Fibroblast", "desc": "Heart panel: generic cardiac fibroblasts maintaining myocardial ECM.", "children": [] },
              { "name": "Fibroblasts", "desc": "Pancreas panel: fibroblasts in pancreatic stroma.", "children": [] },
              { "name": "Stromal Associated Fibroblasts", "desc": "Ovarian: fibroblasts tightly associated with non-tumour stroma.", "children": [] }
            ]
          },
          {
            "name": "Cancer-associated fibroblasts (CAF) and CAF-like clusters",
            "desc": "Fibroblasts activated by tumour; remodel matrix and secrete pro-tumour factors.",
            "children": [
              { "name": "Tumor_Associated_Fibroblast", "desc": "Breast and colon panels: tumour-associated fibroblasts adjacent to malignant regions.", "children": [] },
              { "name": "Tumor Associated Fibroblasts", "desc": "Ovarian panel: CAFs in ovarian carcinoma stroma.", "children": [] },
              { "name": "Fibroblast/CAF", "desc": "Kidney and liver panels: merged fibroblast and CAF population.", "children": [] },
              { "name": "Fibroblast_PDGFRA_CAF", "desc": "Lung panel: PDGFRA-high fibroblast/CAF compartment associated with fibrotic and tumour stroma.", "children": [] }
            ]
          }
        ]
      },
      {
        "name": "Endothelial and vascular lineage (Xenium)",
        "desc": "Endothelial cells from normal and tumour-associated vessels, plus lymphatic endothelium.",
        "children": [
          {
            "name": "Blood vessel endothelium (non-tumour)",
            "desc": "Endothelial cells lining physiologic blood vessels.",
            "children": [
              { "name": "Endothelial", "desc": "Colon, heart, lung, pancreas, breast multi-cancer panels: generic vascular endothelial cells.", "children": [] },
              { "name": "Stromal Associated Endothelial Cells", "desc": "Ovarian: endothelial cells associated with stromal vasculature.", "children": [] }
            ]
          },
          {
            "name": "Lymphatic endothelium",
            "desc": "Endothelial cells lining lymphatic vessels.",
            "children": [
              { "name": "Lymphatic Endothelial Cells", "desc": "Pancreas: lymphatic endothelial cells draining tumour regions.", "children": [] }
            ]
          },
          {
            "name": "Tumour-associated endothelium",
            "desc": "Endothelial cells in tumour-induced neovessels.",
            "children": [
              { "name": "Tumor_Associated_Endothelial", "desc": "Breast and colon: tumour-associated endothelial cells in angiogenic neovessels near malignant clusters.", "children": [] },
              { "name": "Tumor Associated Endothelial Cells", "desc": "Ovarian: tumour-associated endothelial cells in ovarian carcinoma.", "children": [] }
            ]
          }
        ]
      },
      {
        "name": "Immune lineage (Xenium)",
        "desc": "Lymphoid and myeloid immune cells across all Xenium panels.",
        "children": [
          {
            "name": "T and NK cell lineage",
            "desc": "CD4/CD8 T cells, NK cells and tumour-infiltrating T cell populations.",
            "children": [
              { "name": "T_cells", "desc": "Kidney, liver, lung panels: panel-level T cells.", "children": [] },
              { "name": "T Cells", "desc": "Pancreas: T cell cluster in pancreatic tumour microenvironment.", "children": [] },
              { "name": "T and NK Cells", "desc": "Ovarian: mixed T and NK cell cluster representing cytotoxic lymphocytes.", "children": [] }
            ]
          },
          {
            "name": "B lineage and CXCL9/10-high immune cells",
            "desc": "B cells and chemokine-high immune clusters.",
            "children": [
              { "name": "B_lineage", "desc": "Kidney and lung: B-lineage cells including naive/memory B cells.", "children": [] },
              { "name": "B Cells", "desc": "Pancreas: B cells in pancreatic tumour tissue.", "children": [] },
              { "name": "CXCL9/10 Cells", "desc": "Pancreas: CXCL9/10 chemokine-high immune cells, often activated T or myeloid cells in inflamed regions.", "children": [] }
            ]
          },
          {
            "name": "Myeloid and macrophage lineage",
            "desc": "Monocytes, macrophages and other myeloid populations.",
            "children": [
              { "name": "Myeloid", "desc": "Heart, kidney, liver, lung: broad myeloid compartment including monocytes and DCs.", "children": [] },
              { "name": "Macrophage", "desc": "Breast and colon: tumour-associated macrophages in those panels.", "children": [] },
              { "name": "Macrophages", "desc": "Ovarian and pancreas: macrophage populations in those organs.", "children": [] }
            ]
          },
          {
            "name": "Mast cells",
            "desc": "Granule-rich tissue-resident immune cells involved in allergic and inflammatory responses.",
            "children": [
              { "name": "Mast_Cell", "desc": "Breast: mast cells in mammary tissue.", "children": [] },
              { "name": "Mast Cells", "desc": "Pancreas: mast cells in pancreatic tumour stroma.", "children": [] }
            ]
          }
        ]
      },
      {
        "name": "Muscle and perivascular lineage (Xenium)",
        "desc": "Smooth muscle, pericytes and cardiomyocytes in the Xenium panels.",
        "children": [
          {
            "name": "Smooth muscle cells",
            "desc": "Smooth muscle cells in vessel walls and organ muscularis.",
            "children": [
              { "name": "Smooth_Muscle", "desc": "Colon panel: smooth muscle cells around vessels and muscularis mucosae.", "children": [] },
              { "name": "Smooth Muscle Cells", "desc": "Ovarian and pancreas panels: smooth muscle cells in ovarian stroma and pancreatic vessels.", "children": [] }
            ]
          },
          {
            "name": "Pericytes and SMC/Pericyte",
            "desc": "Perivascular mural cells around capillaries and venules.",
            "children": [
              { "name": "SMC/Pericyte", "desc": "Heart and lung: combined smooth muscle cell / pericyte class around small vessels.", "children": [] },
              { "name": "Pericytes", "desc": "Ovarian: pericytes stabilising tumour microvessels.", "children": [] }
            ]
          },
          {
            "name": "Cardiomyocytes",
            "desc": "Working myocardial cells in heart tissue.",
            "children": [
              { "name": "Cardiomyocyte", "desc": "Heart panel: cardiomyocytes with abundant contractile apparatus.", "children": [] }
            ]
          }
        ]
      },
      {
        "name": "Ambiguous / unassigned (Xenium)",
        "desc": "Xenium classes that explicitly encode uncertainty or incomplete assignment.",
        "children": [
          {
            "name": "Low-confidence or ambiguous assignments",
            "desc": "Cells that could not be confidently assigned to a canonical type.",
            "children": [
              { "name": "Ambiguous/Low_confidence", "desc": "Kidney and liver panels: low-confidence cells in ambiguous regions.", "children": [] },
              { "name": "Unassigned", "desc": "Ovarian panel: unassigned cells without a strong cluster membership.", "children": [] }
            ]
          }
        ]
      }
    ]
  }
};

// ------------------------
// Tree building functions
// ------------------------
function buildTree(treeKey, containerId) {
  const treeRoot = treeData[treeKey];
  const rootUl = document.querySelector('#' + containerId + ' .tree ul');
  rootUl.innerHTML = "";
  treeRoot.children.forEach(function(child) {
    addNode(child, rootUl);
  });
}

function addNode(node, parentUl) {
  const li = document.createElement('li');
  if (node.children && node.children.length > 0) {
    li.classList.add('parent');
  } else {
    li.classList.add('leaf');
  }

  const span = document.createElement('span');
  span.textContent = node.name;
  span.className = 'node-label';

  span.onclick = function(event) {
    event.stopPropagation();
    if (node.children && node.children.length > 0) {
      li.classList.toggle('expanded');
    }
    showDescription(node, span);
  };

  li.appendChild(span);

  if (node.children && node.children.length > 0) {
    const childUl = document.createElement('ul');
    li.appendChild(childUl);
    node.children.forEach(function(child) {
      addNode(child, childUl);
    });
  }

  parentUl.appendChild(li);
}

function showDescription(node, spanEl) {
  // clear previous selection
  document.querySelectorAll('.node-label.selected').forEach(function(s) {
    s.classList.remove('selected');
  });
  spanEl.classList.add('selected');

  // compute lineage from this span up to the root of its tree
  const names = [];
  let li = spanEl.parentElement;
  while (li && li.tagName === 'LI') {
    const labelSpan = li.firstElementChild;
    if (labelSpan && labelSpan.classList.contains('node-label')) {
      names.unshift(labelSpan.textContent);
    }
    const parentUl = li.parentElement;
    li = parentUl ? parentUl.closest('li') : null;
  }
  const lineageStr = names.join('  >  ');

  const panel = document.getElementById('node-description');
  let html = '<div><strong>Node:</strong> ' + node.name + '</div>';
  if (lineageStr) {
    html += '<div><strong>Lineage:</strong> ' + lineageStr + '</div>';
  }
  if (node.desc) {
    html += '<div style="margin-top:8px;"><strong>Description:</strong> ' + node.desc + '</div>';
  }
  panel.innerHTML = html;
}

function searchTree(event, treeId) {
  const query = event.target.value.trim().toLowerCase();
  const treePanel = document.getElementById(treeId);
  const treeRoot = treePanel.querySelector('.tree');

  // clear previous search highlights
  treeRoot.querySelectorAll('.node-label.search-hit').forEach(function(span) {
    span.classList.remove('search-hit');
  });

  // collapse all parents
  treeRoot.querySelectorAll('li.parent').forEach(function(li) {
    li.classList.remove('expanded');
  });

  if (!query) {
    return;
  }

  const spans = treeRoot.querySelectorAll('.node-label');
  spans.forEach(function(span) {
    if (span.textContent.toLowerCase().includes(query)) {
      span.classList.add('search-hit');
      // expand all ancestor branches so the hit is visible
      let li = span.parentElement;
      while (li && li.tagName === 'LI') {
        if (li.classList.contains('parent')) {
          li.classList.add('expanded');
        }
        const parentUl = li.parentElement;
        li = parentUl ? parentUl.closest('li') : null;
      }
    }
  });
}

// Global search across all three trees
function searchAllTrees(event) {
  const query = event.target.value.trim().toLowerCase();
  const treeIds = ['tree1', 'tree2', 'tree3'];

  // clear previous highlights and collapse all trees
  treeIds.forEach(function(id) {
    const treePanel = document.getElementById(id);
    const treeRoot = treePanel.querySelector('.tree');
    treeRoot.querySelectorAll('.node-label.search-hit').forEach(function(span) {
      span.classList.remove('search-hit');
    });
    treeRoot.querySelectorAll('li.parent').forEach(function(li) {
      li.classList.remove('expanded');
    });
  });

  if (!query) {
    return;
  }

  treeIds.forEach(function(id) {
    const treePanel = document.getElementById(id);
    const treeRoot = treePanel.querySelector('.tree');
    const spans = treeRoot.querySelectorAll('.node-label');
    spans.forEach(function(span) {
      if (span.textContent.toLowerCase().includes(query)) {
        span.classList.add('search-hit');
        let li = span.parentElement;
        while (li && li.tagName === 'LI') {
          if (li.classList.contains('parent')) {
            li.classList.add('expanded');
          }
          const parentUl = li.parentElement;
          li = parentUl ? parentUl.closest('li') : null;
        }
      }
    });
  });
}

// ------------------------
// Initialise all trees
// ------------------------
buildTree('tree1', 'tree1');
buildTree('tree2', 'tree2');
buildTree('tree3', 'tree3');
</script>

</body>
</html>
